JIT 即时编译器，是一个动态编译技术。用于提高解释语言的性能。通过在运行时将热点代码（经常执行的代码部分）编译成更优化的机器代码。

php是解释型语言，php有一个编译器，但它不像编译语言中的编译器那样儿，没有独立的步骤来运行它，也不会生成二进制文件。编译器是php运行时引擎的一部分：php代码仍然需要被编译-转换成-机器代码；只是在运行php代码时，它会即时进行。

JIT编译器利用了这种解释语言的特点：它在运行时查看代码，并尝试识别所谓的“热点部分”（比其他部分更频繁执行的部分）。JIT会将源代码即时编译为更优化、更适合机器的代码块，以替代原来的代码。有趣的是，这只有在解释语言中才可能实现，因为事先完全编译的程序无法再改变。

试图识别热点部分的机制被称为监视器，它会查看代码，并在运行时监视它。当它检测到多次执行的部分代码时，它会将它们标记成热点，然后可以将热点部分编译成优化的代码块儿。

监视代码和生成JIT代码会带来性能成本，幸运的是，从JIT中获得的好处超过了这个成本。至少在某些情况下是这样。

第二个问题更重要：在常规的mvc应用程序中，几乎没有很多热点部分可以进行优化。当JIT还处于早期阶段时，在PHP社区中共享了一个流行的例子，它展示了使用和不使用JIT生成的分形图像，JIT版本的速度快了很多---十倍左右。可是诚实的说，我们在php程序中很少生成分形图像。

即使在框架层面，很少有代码受益于优化的JIT版本，web应用程序的主要性能瓶颈不是代码本身，而是像发送和接收请求、从文件系统读取数据或与数据库服务器通信等i/o操作。

```
ab -n 100 -c 20 -l localhost:8000

```

使用opcache_get_status()函数查看JIT信息。

![[Pasted image 20231118034020.png]]